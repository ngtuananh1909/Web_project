<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Add Product</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"/>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">
  <script src="https://cdn.quilljs.com/1.3.6/quill.min.js"></script>

  <link rel="shortcut icon" href="#" />
  
  <style>
    .sticky-header {
      position: sticky;
      top: 0;
      z-index: 1000;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }

    .product-card {
      position: relative;
      overflow: hidden;
      transition: transform 0.3s ease;
      display: flex;
      flex-direction: column;
      height: 450px;
    }
    .dark-mode .product-card {
      position: relative;
      overflow: hidden;
      transition: transform 0.3s ease;
      display: flex;
      flex-direction: column;
      height: 450px;
      color: white;
    }

    .product-card img {
      height: 200px;
      object-fit: cover;
      width: 100%;
    }

    .product-card:hover {
      transform: translateY(-5px) scale(1.01);
      box-shadow: 0px 10px 20px rgba(0, 0, 0, 0.1);
    }

    .btn-primary, .btn-danger, .btn-success {
      height: 60px;
      width: 70%;
      transition: transform 0.3s ease;
    }

    .btn:hover {
      transform: translateY(-3px);
    }

    .avatar {
      width: 30px;
      height: 30px;
      border-radius: 50%;
      object-fit: cover;
    }

    .custom {
      display: flex;
    }

    .preview {
      width: 400px;
    }

    #preview-name, #preview-description {
      word-wrap: break-word;
      word-break: break-all;
      white-space: normal;
    }

    .card-body.info {
      width: 100%;
      max-width: 1000px; /* Chiều rộng tối đa để không bị tràn */
      overflow-wrap: break-word;
    }
    .dark-mode .card-body.info {
      width: 100%;
      max-width: 1000px; /* Chiều rộng tối đa để không bị tràn */
      overflow-wrap: break-word;
      color: white;
      background-color: rgb(48, 48, 48);
    }
    

    body {
      background-color: #eeeeee54;
    }
    
    .history-group {
      width: 400px;
      height: 630px;
      color: #ffffff;
      margin-bottom: 80px;
      border: 2px solid #7b7b7b;
    }
    .form-control{
      width: 300px;
      height: 50px;
      color: #ffffff;
      margin-bottom: 80px;
      border: 2px solid #7b7b7b;
    }
    .nav-link {
        position: relative; /* Để sử dụng absolute positioning cho underline */
        display: inline-block;
        padding-bottom: 5px; /* Khoảng cách giữa text và underline */
    }

    .nav-link::after {
        content: ""; /* Nội dung rỗng để tạo thanh nhỏ */
        position: absolute;
        left: 16%;
        bottom: 0;
        width: 70%;
        height: 2px; /* Độ dày của thanh nhỏ */
        background-color: #0056ea; /* Màu của thanh nhỏ */
        transform: scaleX(0); /* Ẩn thanh nhỏ ban đầu */
        transform-origin: bottom right; /* Vị trí bắt đầu hiệu ứng */
        align-items: center;
        transition: transform 0.3s ease; /* Hiệu ứng chuyển tiếp cho thanh nhỏ */
    }

    .nav-link.home:hover::after,
    .nav-link.bxh:hover::after,
    .nav-link.giohang:hover::after,
    .nav-link.taosanpham:hover::after,
    .nav-link.login:hover::after,
    .nav-link.dangky:hover::after {
        transform: scaleX(1); /* Hiện thanh nhỏ khi hover */
        transform-origin: bottom left; /* Vị trí kết thúc hiệu ứng */
    }

    .home-icon {
        width: 30px; /* Thay đổi kích thước của hình ảnh nếu cần */
        height: 30px; /* Thay đổi kích thước của hình ảnh nếu cần */
    }
    .bxh-icon{
      width: 27px; /* Thay đổi kích thước của hình ảnh nếu cần */
      height: 27px;
    }
    .cart-icon{
      width: 23px;
      height: 23px;
    }

    .add-icon{
      width: 30px;
      height: 30px;
    }
    .card-body {
        flex: 1;
      }
    /* Chế độ sáng (mặc định) */
    body {
        background-color: #F5EFFF;
        color: #000;
        transition: background-color 0.3s ease, color 0.3s ease;
      }

      /* Chế độ tối */
      body.dark-mode {
        background-color: #1b1b1b;
        color: #f1f1f1;
      }

      .dark-mode .navbar, .dark-mode .card {
        background-color: #333333;
        color: #f1f1f1;
      }

      .dark-mode .btn-primary {
        background-color: #2897f8;
        border-color: #666;
      }


      .dark-mode a{
        color: #ffffff;
        transition: background-color 0.3s ease, color 0.3s ease;
      }

      .mode-button{
        height: 30px;
        width: 30px;
      }

      .dark-mode .header-design  {
        background-color: #666666fd; /* Màu nền tối cho header */
        color: white;
        transition: background-color 0.3s ease, color 0.3s ease;
      }
      .text-decoration-none{
        color: black;
      }
      .dark-mode .dropdown-menu{
        background-color: #0c0c0c;
        transition: background-color 0.3s ease, color 0.3s ease;
      }
      .dropdown-menu {
        display: none;
        position: absolute;
        top: 100%; /* Đặt menu xuất hiện ngay dưới avatar */
        left: 0;
        z-index: 1000;
      }
      .nav-link.dropdown-toggle:hover + .dropdown-menu,
      .dropdown-menu:hover {
        display: block;
      }

      .dropdown-item{
        color: rgb(0, 0, 0);
        text-decoration: none;
        transition: background-color 0.3s ease, color 0.3s ease;
      }
      .dropdown-menu{
        color: white;
        transition: background-color 0.5s ease, color 0.5s ease;
      }
      #toggle-dark-mode {
        border: none; /* Loại bỏ khung viền */
        outline: none; /* Loại bỏ viền khi nhấn vào nút */
        background: none; /* Loại bỏ màu nền mặc định */
        cursor: pointer; /* Thay đổi con trỏ khi di chuột qua nút */
      }
      .header-design{
        position: sticky;
        background-color: #e2e2e2;
        top: 0px; 
        z-index: 1000;
      }
      .alpha{
        color: #000;
      }
      .dark-mode .alpha{
        color: white;
      }
      .table{
        background-color: white;
      }
      .dark-mode .table{
        background-color: rgb(49, 49, 49);
        color: white;
      }
      .form-group{
        color: #000;
        background-color: white;
      }
      .dark-mode .form-group{
        color: #ffffff;
        background-color: rgb(48, 48, 48);
      }
      .button-input{
        background-color: #f5fff0;
        color: #000;
      }
      .dark-mode .button-input{
        background-color: #676767;
        color: white;
      }

      #editor {
        height: auto; /* Thay đổi chiều cao */
        width: 670px; /* Thay đổi chiều rộng */
        color: #000;
        background-color: white;
      }
      .dark-mode #editor {
        height: auto; /* Thay đổi chiều cao */
        width: 670px; /* Thay đổi chiều rộng */
        color: #ffffff;
        background-color: rgb(53, 53, 53);
      }
      .button-submit{
        background-color: #47ea72;
      }
      #quantity::placeholder {
        color: #000000; /* Màu đỏ, bạn có thể thay đổi sang màu khác */
      }
      #name::placeholder {
        color: #000000; /* Màu đỏ, bạn có thể thay đổi sang màu khác */
      }
      #price::placeholder {
        color: #000000; /* Màu đỏ, bạn có thể thay đổi sang màu khác */
      }

      .dark-mode #quantity::placeholder {
        color: #ffffff; /* Màu đỏ, bạn có thể thay đổi sang màu khác */
      }
      .dark-mode #name::placeholder {
        color: #ffffff; /* Màu đỏ, bạn có thể thay đổi sang màu khác */
      }
      .dark-mode #price::placeholder {
        color: #ffffff; /* Màu đỏ, bạn có thể thay đổi sang màu khác */
      }

     /* Style for the switch */
      .switch {
        position: relative;
        display: inline-block;
        width: 48px; /* Tăng chiều rộng để có đủ không gian cho nút */
        height: 24px; /* Điều chỉnh chiều cao */
        margin-left: 15px; /* Khoảng cách giữa nhãn và công tắc */
      }

      .switch input {
        opacity: 0;
        width: 0;
        height: 0;
      }

      .slider {
        position: absolute;
        cursor: pointer;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-color: #d6d6d6; /* Màu nền ban đầu của thanh chuyển */
        transition: 0.4s;
      }

      .slider:before {
        position: absolute;
        content: "";
        height: 18px; /* Kích thước của nút */
        width: 18px;
        left: 3px;
        bottom: 3px;
        background-color: white;
        transition: 0.4s;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.3); /* Đổ bóng cho nút */
      }

      input:checked + .slider {
        background-color: #4CAF50; /* Màu nền khi chế độ tối được bật */
      }

      input:checked + .slider:before {
        transform: translateX(24px); /* Điều chỉnh độ dịch chuyển khi bật */
      }

      .slider.round {
        border-radius: 34px; /* Bo góc cho thanh chuyển */
      }

      .slider.round:before {
        border-radius: 50%; /* Bo góc cho nút */
      }

      .change-mode {
        font-size: 14px; /* Kích thước chữ dễ nhìn hơn */
        font-weight: 500; /* Tăng độ đậm của chữ */
        color: #333; /* Màu chữ cân bằng giữa sáng và tối */
      }
      .dark-mode .change-mode {
        font-size: 14px; /* Kích thước chữ dễ nhìn hơn */
        font-weight: 500; /* Tăng độ đậm của chữ */
        color: #ffffff; /* Màu chữ cân bằng giữa sáng và tối */
      }

      .decresion {
          background-color: white !important;
          color: #000 !important;
          padding: 10px !important;
          border-radius: 8px !important;
      }

      .dark-mode .decresion {
          background-color: rgb(48, 48, 48) !important;
          color: white !important;
      }

      

  </style>
</head>
  <body>
    <header class="header-design">
      <div class="container-fluid py-3">
        <div class="container d-flex justify-content-between align-items-center" style="margin-left: 415px;">
          <h1 class="h4 mb-0">
            <a href="/" class="text-decoration-none" style="margin-left: -130px;"><strong>E-Shop</strong></a>
          </h1>
          <nav class="nav">
            <ul class="nav">
              <li class="nav-item">
                <a class="nav-link home" href="/">
                  <img src="/img/home.png" alt="" class="home-icon"></img>
                </a>
              </li>
              <li class="nav-item">
                <a class="nav-link bxh" href="/scoreboard">
                  <img src="/img/bxh.jpg" alt="" class="bxh-icon">
                </a>
              </li>
              <% if (!user) { %>
              <li class="nav-item">
                <a class="nav-link login" href="/login">Đăng nhập</a>
              </li>
              <li class="nav-item">
                <a class="nav-link dangky" href="/register">Đăng ký</a>
              </li>
              <% } else { %>
              <li class="nav-item">
                <a class="nav-link giohang" href="/cart">
                  <img src="/img/cart.jpg" alt="" class="cart-icon">                  
                </a>
              </li>
              <li class="nav-item">
                <a class="nav-link taosanpham" href="/product/add">
                  <img src="/img/add.jpg" alt="" class="add-icon">
                </a>
              </li>
              <li class="nav-item dropdown" style="width: 200px;">
                <a class="nav-link dropdown-toggle d-flex align-items-center" id="userDropdown" role="button">
                  <% if (user.avatar) { %>
                  <img src="/<%= user.avatar %>" class="avatar me-2" alt="" />
                  <% } else { %>
                  <img src="./img/def.jpg" class="avatar me-2" alt="" />
                  <% } %>
                </a>
                <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="userDropdown">
                  <li>
                    <a class="dropdown-item" href="/user/<%= user.id %>">Profile</a>
                  </li>
                  <li><a class="dropdown-item" href="/settings">Cài đặt</a></li>
                  <li><a class="dropdown-item">Balanced: <%= user.balance %> VNĐ</a></li>
                  <li><hr class="dropdown-divider" /></li>
                  <!-- Chuyển đổi giao diện -->
                  <li class="nav-item">
                    <div class="d-flex align-items-center px-3 py-2">
                      <label class="change-mode" for="toggle-dark-mode" id="mode-label">Chế Độ Sáng</label>
                      <label class="switch" >
                        <input type="checkbox" id="toggle-dark-mode">
                        <span class="slider round"></span>
                      </label>
                    </div>
                  </li>
                  <li><hr class="dropdown-divider" /></li>
                  <li><a class="dropdown-item" href="/logout">Đăng xuất</a></li>
                </ul>
              </li>                       
              <% } %>
            </ul>
          </nav>
        </div>
      </div>
    </header>
    <div class="custom table">
      <div class="preview" style="margin-left: 10px;">
        <!-- Thêm vào phần preview -->
        <div class="cropper-container" style="display: none;">
          <h2>Crop Image</h2>
          <div id="cropper-area">
            <img id="cropper-image" src="" alt="Image for Cropping" />
          </div>
          <button id="crop-button" class="btn btn-primary">Crop and Save</button>
        </div>
        <h2 class="alpha">Product Preview</h2>
        <div class="card product-card" style="width: 650px; height: 650px; border: 2px solid #7b7b7b;">
          <img id="preview-image" class="card-img-top" src="" alt="Product Image">
          <div class="card-body info">
            <h3 id="preview-name" class="card-title alpha">Name</h3>
            <p id="preview-price" class="card-text alpha">Price: 0 VND</p>
            <p id="preview-quantity" class="card-text alpha">Quantity: 0</p>
            <p id="preview-sale" class="card-text alpha" style="display:none;">Sale Value: 0%</p>
            <p id="preview-description" class="card-text alpha">Decrision</p>
          </div>
        </div>
      </div>
      <div class="form-container" style="margin-left: 75px;">
        <h1 style="margin-left: 350px;">Add New Product</h1>
        <form id="product-form" action="/product/auth/add" method="POST" enctype="multipart/form-data">
          <!-- Tên sản phẩm -->
          <div class="form-group" style="margin-left: 200px; margin-top: 30px;">
            <input type="text" id="name" name="name" class="form-control button-input" style="border: 2px solid #7b7b7b; margin-left: 4px; margin-top: -10px;" required placeholder="Product name">
          </div>
        
          <!-- Giá sản phẩm -->
          <div class="form-group " style="margin-left: 550px; margin-top: -147px;">
            <input type="number" id="price" name="price" class="form-control button-input" step="100" style="border: 2px solid #7b7b7b;" required min="100" placeholder="Enter Price">
          </div>
        
          <!-- Số lượng sản phẩm -->
          <div class="form-group alpha" style="margin-left: 552px; margin-top: -67px;">
            <input type="number" id="quantity" name="quantity" class="form-control button-input" style="border: 2px solid #7b7b7b;" required min="1" placeholder="Enter quantity">
          </div>
        
          <!-- Hình ảnh sản phẩm -->
          <div class="form-group alpha" style="margin-top: -147px; margin-left: 206px; width: 300px;">
            <input type="file" id="image" name="image" class="form-control button-input" style="height: 50px;" accept="image/*" required>
          </div>
        
          <!-- Sale checkbox -->
          <div class="form-check alpha" style="margin-left: 277px; margin-top: -80px; width: 100px; background-color: transparent; display: flex; align-items: center;">
            <input type="checkbox" id="sale" name="sale" class="form-check-input" style="height: 1px; width: 1px; margin-right: -50px;" onclick="toggleSaleValue()">
            <label for="sale" style="position: relative; display: inline-block; justify-content: center; width: 60px; height: 40px; border-radius: 8px; color: #1e1b1b; background-color: lightgray; text-align: center; cursor: pointer; font-size: 25px;">
              Sale
              <input type="checkbox" style="opacity: 0; position: absolute; width: 0%; height: 0%; cursor: pointer;">
            </label>
          </div>
      
          <div class="form-group" id="sale-value-container" style="display: none; margin-left: 286px; margin-top: -58px; height: auto; width: auto; background-color: transparent;">
            <input type="number" id="saleval" name="saleval" class="form-control button-input" style="height: auto; width: auto;" min="1" max="99" step="1" placeholder="% Sale">
          </div>
          <div class="form-group" style="margin-left: 195px; margin-bottom: 100px;">
            <div id="editor" style="height: 200px;"></div>
            <input type="hidden" id="description" name="description">
          </div>
          <button type="submit" class="btn btn-success button-submit" style="margin-top: -25px; margin-left: 510px; width: 350px; background-color: #2897f8;">Add Product</button>
        </form>
      </div>

      
      <div class="form-container " style="margin-left: 10px;">
        <h1>History</h1>
          <div class="history-group ">
              <name="history" class="form-control button-input" rows="4" required></textarea>
          </div>
      </div>

    </div>
    
    
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.slim.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.12/cropper.min.js"></script>

    <script>
      document.addEventListener("DOMContentLoaded", function () {
      // Lấy các phần tử input và các phần tử xem trước
      const nameInput = document.getElementById("name");
      const priceInput = document.getElementById("price");
      const quantityInput = document.getElementById("quantity");
      const imageInput = document.getElementById("image");
      const saleInput = document.getElementById("sale");
      const saleValueInput = document.getElementById("saleval");

      const previewName = document.getElementById("preview-name");
      const previewPrice = document.getElementById("preview-price");
      const previewQuantity = document.getElementById("preview-quantity");
      const previewImage = document.getElementById("preview-image");
      const previewSale = document.getElementById("preview-sale");

      // Cập nhật xem trước tên sản phẩm
      nameInput.addEventListener("input", function () {
        previewName.textContent = nameInput.value || "Product Name";
      });

      // Cập nhật xem trước giá sản phẩm
      priceInput.addEventListener("input", function () {
        previewPrice.textContent = "Price: " + (priceInput.value ? priceInput.value + " VND" : "0 VND");
      });

      // Cập nhật xem trước số lượng sản phẩm
      quantityInput.addEventListener("input", function () {
        previewQuantity.textContent = "Quantity: " + (quantityInput.value ? quantityInput.value : "0");
      });

      // Cập nhật xem trước mô tả
      document.getElementById("description").addEventListener("input", function() {
        var description = document.getElementById("description").value;
        document.getElementById("preview-description").innerText = description;
      });

      // Cập nhật xem trước giá trị giảm giá
      saleValueInput.addEventListener("input", function () {
        previewSale.textContent = "Sale Value: " + (saleValueInput.value ? saleValueInput.value + "%" : "0%");
      });

      // Cập nhật ảnh xem trước
      imageInput.addEventListener("change", function () {
        const file = imageInput.files[0];
        if (file) {
          const reader = new FileReader();
          reader.onload = function (e) {
            previewImage.src = e.target.result;
          };
          reader.readAsDataURL(file);
        }
      });

      // Hiện/ẩn giá trị giảm giá trong xem trước
      saleInput.addEventListener("change", function () {
        previewSale.style.display = saleInput.checked ? "block" : "none";
        if (saleInput.checked) {
          previewSale.textContent = "Sale Value: " + (saleValueInput.value ? saleValueInput.value + "%" : "0%");
        } else {
          previewSale.textContent = ""; // Ẩn giá trị giảm giá nếu không được chọn
        }
      });
    });
    // Cập nhật xem trước mô tả
    document.getElementById("editor").addEventListener("input", function () {
      var description = quill.root.innerHTML; // Lấy nội dung từ editor
      document.getElementById("preview-description").innerHTML = description; // Cập nhật mô tả xem trước
    });


</script>

<script>
  document.addEventListener("DOMContentLoaded", function () {
  const toggleDarkMode = document.getElementById("toggle-dark-mode");
  const modeLabel = document.getElementById("mode-label");

  // Kiểm tra chế độ hiện tại từ localStorage (nếu có)
  if (localStorage.getItem("darkMode") === "enabled") {
    document.body.classList.add("dark-mode");
    toggleDarkMode.checked = true;
    modeLabel.textContent = "Chế Độ Dark ";
  }

  // Xử lý sự kiện khi chuyển đổi chế độ
  toggleDarkMode.addEventListener("change", function () {
    if (toggleDarkMode.checked) {
      document.body.classList.add("dark-mode");
      modeLabel.textContent = "Chế Độ Dark ";
      localStorage.setItem("darkMode", "enabled"); // Lưu trạng thái
    } else {
      document.body.classList.remove("dark-mode");
      modeLabel.textContent = "Chế Độ Sáng";
      localStorage.setItem("darkMode", "disabled"); // Lưu trạng thái
    }
  });
});

  document.getElementById('chat-header').onclick = function() {
      const chatBody = document.getElementById('chat-body');
      const chatHeader = document.getElementById('chat-header');

      chatHeader.style.display = 'none'; // Ẩn nút Chat
      chatBody.style.display = 'block'; // Hiện ô chat

      setTimeout(() => {
          chatBody.classList.add('active'); // Hiện ô chat với hiệu ứng phóng to
      }, 10); // Đảm bảo transition diễn ra
  }

  // Đóng ô chat
  document.getElementById('close-chat').onclick = function() {
      const chatBody = document.getElementById('chat-body');
      const chatHeader = document.getElementById('chat-header');

      chatBody.classList.remove('active'); // Thu nhỏ ô chat
      setTimeout(() => {
          chatBody.style.display = 'none'; // Ẩn ô chat
          chatHeader.style.display = 'block'; // Hiện lại nút Chat
      }, 300); // Thời gian thu nhỏ
  }



</script>
  
  <script>
    var quill = new Quill('#editor', {
      theme: 'snow'
    });

    var form = document.getElementById('product-form');
    form.onsubmit = function() {
      var descriptionInput = document.getElementById('description');
      descriptionInput.value = quill.root.innerHTML;
    };
  
    function toggleSaleValue() {
      var saleCheckbox = document.getElementById('sale');
      var saleValueContainer = document.getElementById('sale-value-container');
      if (saleCheckbox.checked) {
        saleValueContainer.style.display = 'block';
      } else {
        saleValueContainer.style.display = 'none';
      }
    }
  </script>

  </body>
</html>
