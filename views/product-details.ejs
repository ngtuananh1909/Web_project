    <!DOCTYPE html>
    <html lang="en">

    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
        <title><%= product.name %> - Product Details</title>
        <style>
            body {
                font-family: Arial, sans-serif;
                background-color: #f3f4f6;
                margin: 0;
                padding: 0;
                display: flex;
                flex-direction: column;
                align-items: center;
                padding-top: 80px;
            }

            .avatar {
                width: 30px;
                height: 30px;
                border-radius: 50%;
                object-fit: cover;
            }

            .container {
                max-width: 1200px;
                background: #fff;
                padding: 0.2px;
                display: flex;
                gap: 20px;
            }

            .image-container {
                flex: 1;
                display: flex;
                justify-content: center;
                align-items: center;
            }

            .image-container img {
                max-width: 100%;
                object-fit: cover;
                border-radius: 8px;
                max-height: 600px;
            }

            .details-container {
                flex: 2;
                display: flex;
                flex-direction: column;
            }

            h1 {
                font-size: 2.5rem;
                font-weight: bold;
                margin-bottom: 20px;
                width: 57%;
                margin-top: 112px;
                
            }

            h2 {
                font-size: 2rem;
                font-weight: bold;
                margin-bottom: 10px;
            }

            p {
                margin-bottom: 10px;
            }

            .buy-now{
                display: inline-block;
                padding: 15px 60px;
                margin: 10px 5px;
                font-size: 16px;
                font-weight: bold;
                color: #ffffff;
                text-align: center;
                text-decoration: none;
                border-radius: 30px;
                transition: background-color 0.3s ease;
                background-color: #48bb78;
            }
            .add-to-cart {
                display: inline-block;
                padding: 15px 60px;
                margin: 10px 5px;
                font-size: 16px;
                font-weight: bold;
                color: #ffffff;
                text-align: center;
                text-decoration: none;
                border-radius: 30px;
                transition: background-color 0.3s ease;
                background-color: #4299e1;
            }


            .related-products {
                margin-top: 40px;
                max-width: 1110px;
                width: 100%;
            }

            .related-products h2 {
                font-size: 2rem;
                font-weight: bold;
                text-align: center;
                margin-bottom: 20px;
            }

            .products {
                display: flex;
                flex-wrap: wrap;
                justify-content: flex-start; /* Sắp xếp các sản phẩm từ trái sang phải */
                gap: 20px;
                margin: 0 10px; /* Thêm khoảng cách lề trái và phải */
            }

            .product-card {
                background-color: #ffffff;
                border-radius: 8px;
                box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
                overflow: hidden;
                display: flex;
                flex-direction: column;
                width: 250px;
                height: 500px;
                transition: transform 0.3s, box-shadow 0.3s;
                margin-bottom: 20px;
            }

            .product-card:hover {
                transform: translateY(-5px) scale(1.01);
                box-shadow: 0px 10px 20px rgba(0, 0, 0, 0.1);
            }

            .products {
                width: calc(100% - 20px); /* Đảm bảo khoảng cách lề trái và phải là 10px */
            }

            .product-card img {
                width: 100%;
                height: 200px; /* Chiều cao cố định cho hình ảnh */
                object-fit: cover;
            }

            .card-body {
                flex: 1; /* Chiếm không gian còn lại */
                padding: 15px;
            }

            .product-card .info {
                text-align: center;
            }

            .btn-primary,
            .btn-danger,
            .btn-success {
                height: 60px;
                width: 100%;
                border-radius: 15px;
                transition: transform 0.3s ease;
                text-align: center;
                padding: 10px;
                margin: 10px 0;
            }

            .btn-primary:hover,
            .btn-danger:hover,
            .btn-success:hover {
                transform: translateY(-3px);
            }
            
            .product-card .info h3 {
                font-size: 18px;
                font-weight: bold;
                color: #2d3748;
                margin: 10px 0;
            }

            .product-card .info p {
                color: #718096;
                margin: 10px 0;
            }

            .product-card .info a {
                display: block;
                padding: 10px 20px;
                background-color: #4299e1;
                color: #ffffff;
                border-radius: 8px;
                text-decoration: none;
                font-weight: bold;
                transition: background-color 0.3s ease;
            }

            .product-card .info a:hover {
                background-color: #3182ce;
            }
            .header-container{
                max-width: 1902px;
                width: 667%;
                left: 0;
                position: fixed;

            }
            .nav-link{
                font-size: 15.5px;
            }
            .tuan_anh{
                margin-top:250px ;
            }

            .mt-3{
                width: 220px;
            }

            .addToCartBtn{
                width: 100px;
            }

            .header-container {
                max-width: 1902px;
                width: 667%;
                left: 0;
                position: fixed;
                top: 0; /* Giữ header ở vị trí đầu trang */
                z-index: 1000; /* Đảm bảo header có z-index cao để không bị che */
            }
            

            .header-container {
                background-color: #ffffff; /* Màu nền sáng cho chế độ sáng */
                color: #2d3748; /* Màu chữ sáng */
            }

            /* Định nghĩa chung cho chế độ sáng */
            body {
                font-family: Arial, sans-serif;
                background-color: #f3f4f6;
                color: #2d3748;
            }

            /* Khi bật chế độ tối, thêm class "dark-mode" vào body */
            body.dark-mode {
                background-color: #1a202c;
                color: #f7fafc;
            }

            body.dark-mode .container {
                background-color: #2d3748;
            }

            .image-container img {
                border: 2px solid #f7fafc;
            }

            h1, h2, p {
                color: #2d3748;
            }
            .buy-now,
            .add-to-cart {
                color: #ffffff;
                transition: background-color 0.3s ease;
            }

            .buy-now {
                background-color: #48bb78;
            }

            body.dark-mode .buy-now {
                background-color: #38a169;
            }

            .add-to-cart {
                background-color: #4299e1;
            }

            body.dark-mode .add-to-cart {
                background-color: #3182ce;
            }

            .product-card {
                background-color: #ffffff;
                color: #2d3748;
            }

            body.dark-mode .product-card {
                background-color: #2d3748;
                color: #f7fafc;
            }

            .product-card:hover {
                box-shadow: 0px 10px 20px rgba(255, 255, 255, 0.1);
            }

            /* Đổi màu cho header và nav */
            .header-container {
                background-color: #ffffff;
                color: #2d3748;
            }

            body.dark-mode .header-container {
                background-color: #2d3748;
                color: #f7fafc;
            }

            .nav-link {
                color: #1d68ea;
            }

            body.dark-mode .nav-link {
                color: #f7fafc;
            }

            /* Đổi màu cho dropdown */
            .dropdown-menu {
                background-color: #ffffff;
                color:white ;
            }

            body.dark-mode .dropdown-menu {
                background-color: #2d3748;
                color: #f7fafc;
            }

            /* Thay đổi thanh nhỏ dưới liên kết khi hover */
            .nav-link {
                position: relative; /* Để sử dụng absolute positioning cho underline */
                display: inline-block;
                padding-bottom: 5px; /* Khoảng cách giữa text và underline */
            }

            .nav-link::after {
                content: ""; /* Nội dung rỗng để tạo thanh nhỏ */
                position: absolute;
                left: 16%;
                bottom: 0;
                width: 70%;
                height: 2px; /* Độ dày của thanh nhỏ */
                background-color: #0056ea; /* Màu của thanh nhỏ */
                transform: scaleX(0); /* Ẩn thanh nhỏ ban đầu */
                transform-origin: bottom right; /* Vị trí bắt đầu hiệu ứng */
                align-items: center;
                transition: transform 0.3s ease; /* Hiệu ứng chuyển tiếp cho thanh nhỏ */
            }

            .nav-link.home:hover::after,
            .nav-link.bxh:hover::after,
            .nav-link.giohang:hover::after,
            .nav-link.taosanpham:hover::after,
            .nav-link.login:hover::after,
            .nav-link.dangky:hover::after {
                transform: scaleX(1); /* Hiện thanh nhỏ khi hover */
                transform-origin: bottom left; /* Vị trí kết thúc hiệu ứng */
            }

            .card-body.info {
                width: 100%;
                max-width: 700px; /* Chiều rộng tối đa để không bị tràn */
                overflow-wrap: break-word;
                font-size: 20px;
            }
            
            .home-icon {
                width: 30px; /* Thay đổi kích thước của hình ảnh nếu cần */
                height: 30px; /* Thay đổi kích thước của hình ảnh nếu cần */
            }
            .bxh-icon{
            width: 27px; /* Thay đổi kích thước của hình ảnh nếu cần */
            height: 27px;
            }
            .cart-icon{
            width: 23px;
            height: 23px;
            }

            .add-icon{
            width: 30px;
            height: 30px;
            }
            .m1{
                font-size: 50px;
            }
                  /* Ẩn menu mặc định */
            .dropdown-menu {
                display: none;
                position: absolute;
                top: 100%; /* Đặt menu xuất hiện ngay dưới avatar */
                left: 0;
                z-index: 1000;
            }

            /* Hiển thị menu khi di chuột vào avatar */
            .nav-link.dropdown-toggle:hover + .dropdown-menu,
            .dropdown-menu:hover {
                display: block;
            }

        </style>
    </head>

    <body>
        <header>
            <div class="bg-light py-3 header-container" style="margin-left: -4px;">
                <div class="container d-flex justify-content-between align-items-center">
                    <h1 class="h4 mb-0">
                        <a href="/" class="text-decoration-none text-dark" style="margin-left: -50px;"><strong>E-Shop</strong></a>
                    </h1>
                    <nav class="nav">
                        <ul class="nav">
                            <li class="nav-item">
                                <a class="nav-link home" href="/">
                                    <img src="/img/home.jpg" alt="" class="home-icon"></img>
                                </a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link bxh" href="/">
                                    <img src="/img/bxh.jpg" alt="" class="bxh-icon">
                                </a>
                            </li>
                            <% if (!user) { %>
                                <li class="nav-item">
                                    <a class="nav-link login" href="/login">Đăng nhập</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link dangky" href="/register">Đăng ký</a>
                                </li>
                                <% } else { %>
                                    <li class="nav-item">
                                        <a class="nav-link giohang" href="/cart">
                                            <img src="/img/cart.jpg" alt="" class="cart-icon">
                                        </a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link taosanpham" href="/product/add">
                                            <img src="/img/add.jpg" alt="" class="add-icon">
                                        </a>
                                    </li>
                                    <li class="nav-item dropdown">
                                        <a class="nav-link dropdown-toggle d-flex align-items-center" id="userDropdown" role="button">
                                          <% if (user.avatar) { %>
                                          <img src="<%= user.avatar %>" class="avatar me-2" alt="" />
                                          <% } else { %>
                                          <img src="./img/def.jpg" class="avatar me-2" alt="" />
                                          <% } %>
                                        </a>
                                        <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="userDropdown">
                                          <li>
                                            <a class="dropdown-item" href="/user/<%= user.id %>">Profile</a>
                                          </li>
                                          <li><a class="dropdown-item" href="/settings">Cài đặt</a></li>
                                          <li><a class="dropdown-item">Balanced: <%= user.balance %> VNĐ</a></li>
                                          <li><hr class="dropdown-divider" /></li>
                                          <li><a class="dropdown-item" href="/logout">Đăng xuất</a></li>
                                        </ul>
                                      </li>
                                <% } %>
                        </ul>
                    </nav>
                </div>
            </div>
        </header>
        <m1 style="font-size: 50px;"><strong><center>Product Details</center></strong></m1>
        <div class="container">
            <div class="image-container">
                <% if (product.image) { %>
                    <img src="/uploads/<%= product.image %>" alt="<%= product.name %> Image">
                <% } %>
            </div>
            <div class="card-body info">
                <div class="details-container">
                    <h2><center><%= product.name %></center></h2>
                    <% if (product.sale) { %>
                        <p class="card-text" style="margin-bottom:4px ;">
                            <span class="badge bg-danger ms-2" style="margin-bottom: 10px;" >-<%= product.saleval %>%</span>
                            <br>
                            <strong>Price:</strong><del> <%= product.price %> </del>
                            <%= (product.price - (product.price * product.saleval /
                            100)).toFixed(2)%> VNĐ
                          </p>
                    <% } else { %>
                        <p><strong>Price:</strong> <%= product.price %> VNĐ</p>
                    <% } %>            
                    <p><strong>Description:</strong> <%= product.description %></p></div>
                    <p><strong>Quantity:</strong> <%= product.quantity %></p>
                    <div class="tuan_anh">
                        <a href="" class="buy-now">Buy Now</a>
                        <a href="" class="add-to-cart">Add to Cart</a>
                        <div style="margin-left: 20px;"><a href="/scoreboard">Bestsellers</a></div>
                    </div>
                </div>
            </div>
        </div>
        <main style="width: 58%;">
                <div class="row mt-5">
                    <div class="col">
                        <h2 class="section-title text-center">Sản phẩm gợi ý</h2>
                        <div class="row row-cols-1 row-cols-md-5 g-4" style="margin-left:-10px; gap: 50px;">
                            <% products.forEach(product=> { %>
                                <div class="col">
                                    <div class="card product-card" >
                                      <a href="/product/<%= product.id %>">
                                        <img
                                          src="/uploads/<%= product.image %>"
                                          class="card-img-top"
                                          alt=""
                                        />
                                      </a>
                                      <div class="card-body">
                                        <h4 class="card-title"><center><%= product.name %></center></h4>
                                        <% if (product.sale) { %>
                                          <center><span class="badge bg-danger ms-2" style="margin-bottom: 5px;" >-<%= product.saleval %>%</span></center>
                                          <p class="card-text" style="margin-bottom:4px ;">
                                            Giá:<del> <%= product.price %> </del>
                                            <%= (product.price - (product.price * product.saleval /
                                            100)).toFixed(2)%> VNĐ
                                          </p>
                                          <div style="padding-left: 1px; padding-bottom: 10px">
                                            <div class ="creator-day" style ="margin-top: -0px;">
                                                <p class="card-text" style="margin-bottom: 3px">
                                                  Creator: <%= product.creator %>
                                                </p>
                                                <p class="card-text" style="margin-top: 0px">
                                                    Ngày tạo: <%= product.formatted_date %>
                                                </p>
                                            </div>
                                            <div class="d-flex mt-3" style="gap: 10px; margin-top: -100px;">
                                                <a href="/product/<%= product.id %>" class="btn btn-success rounded center-text">
                                                    <div>Thông tin</div>
                                                    <div>sản phẩm</div>
                                                </a>
                                                <a>
                                                    <button type="button" class="btn btn-primary rounded addToCartBtn" data-product-id="<%= product.id %>">
                                                        Thêm vào giỏ
                                                    </button>
                                                </a>
                                            </div>                                            
                                        <% } else { %>
                                          <div style="margin-top: 40px;">
                                              <p class="card-text">Giá: <%= product.price %> VNĐ</p>
                                          </div>
                                          <div style="padding-left: -10px; padding-bottom: 10px">
                                            <div class ="creator-day" style ="margin-top:1px;">
                                                <p class="card-text" style="margin-bottom: -2px">
                                                  Creator: <%= product.creator %>
                                                </p>
                                                <p class="card-text" style="margin-top: 3px">
                                                  Ngày tạo: <%= product.formatted_date %>
                                                </p>
                                            </div>
                                            <div class="d-flex mt-3" style="gap: 10px; margin-top: 30px;">
                                                <a href="/product/<%= product.id %>" class="btn btn-success rounded center-text">
                                                    <div>Thông tin</div>
                                                    <div>sản phẩm</div>
                                                </a>
                                                <a>
                                                    <button type="button" class="btn btn-primary rounded addToCartBtn" data-product-id="<%= product.id %>">
                                                        Thêm vào giỏ
                                                    </button>
                                                </a>
                                            </div>
                                        <% } %>
                                      </div>
                                      </div>
                                    </div>
                                  </div>
                                <% }); %>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </body>

    </html>